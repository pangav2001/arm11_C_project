#include "game.h"
#include <stdlib.h>

static int get_max_x(char **view)
{
    return strlen(view[0]);
}

static int get_max_y(char **view)
{
    int y = 0;
    for (; view[y]; y++)
        ;
    return y;
}

void init_map(game_t *game)
{
    MAP = (map_t *)malloc(sizeof(map_t));

    char *view_test[24] = {
        "#######################################",
        "# . . . . . . . . ### . . . . . . . . #",
        "# O ### . ##### . ### . ##### . ### O #",
        "# . . . . . . . . . . . . . . . . . . #",
        "# . ### . # . ########### . # . ### . #",
        "# . . . . # . . . ### . . . # . . . . #",
        "####### . ##### . ### . ##### . #######",
        "      # . # . . . . . . . . # . #      ",
        "      # . # . ###-----### . # . #      ",
        "####### . # . #         # . # . #######",
        "        . . . #         # . . .        ",
        "####### . # . #         # . # . #######",
        "      # . # . ########### . # . #      ",
        "      # . # . . . . . . . . # . #      ",
        "####### . # . ########### . # . #######",
        "# . . . . . . . . ### . . . . . . . . #",
        "# O ### . ##### . ### . ##### . ### O #",
        "# . . # . . . . . . . . . . . . # . . #",
        "### . # . # . ########### . # . # . ###",
        "# . . . . # . . . ### . . . # . . . . #",
        "# . ########### . ### . ########### . #",
        "# . . . . . . . . . . . . . . . . . . #",
        "#######################################",
        NULL};

    MAP->view = calloc(24, sizeof(char *)); //
    for (int i = 0; i < 23; i++)
    {
        MAP->view[i] = strdup(view_test[i]);
    }
    MAP->view[24] = NULL;

    MAP->max_x = get_max_x(MAP->view);
    MAP->max_y = get_max_y(MAP->view);

    MAP->pacman_start_offset = 6;
}
